<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>Mobilekit Mobile UI Kit</title>
    <meta name="description" content="Mobilekit HTML Mobile UI Kit">
    <meta name="keywords" content="bootstrap 5, mobile template, cordova, phonegap, mobile, html" />
    <link rel="icon" type="image/png" href="/static/assets/img/favicon.png" sizes="32x32">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/assets/img/icon/192x192.png">
    <link rel="stylesheet" href="/static/assets/css/style.css">
    <link rel="manifest" href="__manifest.json">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>

</head>

<body>
    <!-- loader -->
    <div id="loader">
        <div class="spinner-border text-primary" role="status"></div>
    </div>
    <!-- * loader -->

    <!-- * Extra Header -->
        <input id="pac-input" type="text" class="controls" placeholder="Search..." style="margin-top: 16px; border: 3px solid transparent; border-radius: 5px 5px 5px 5px;
        height: 2rem; outline: none; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3); width: 25rem">
        <div id='map' style="height: 90rem"></div>
    <!-- * App Capsule -->

    <!-- App Bottom Menu -->
    <div class="appBottomMenu">
        <a href="/" class="item">
            <div class="col">
                <ion-icon name="home-outline"></ion-icon>
            </div>
        </a>
        <a href="/discover" class="item">
            <div class="col">
                <ion-icon name="search-outline"></ion-icon>
            </div>
        </a>
        <a href="/add_event" class="item">
            <div class="col">
                <ion-icon name="add-circle-outline"></ion-icon>
            </div>
        </a>
        <a href="/notifications" class="item">
            <div class="col">
                <ion-icon name="notifications-outline"></ion-icon>
                <span class="badge badge-danger">5</span>
            </div>
        </a>
        <a href="#" class="item" data-bs-toggle="modal" data-bs-target="#sidebarPanel">
            <div class="col">
                <ion-icon name="menu-outline"></ion-icon>
            </div>
        </a>
    </div>
    <!-- * App Bottom Menu -->

    <!-- App Sidebar -->
    <div class="modal fade panelbox panelbox-left" id="sidebarPanel" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body p-0">

                    <!-- profile box -->
                    <div class="profileBox">
                        <div class="image-wrapper">
                            <img src="/static/assets/img/sample/avatar/avatar1.jpg" alt="image" class="imaged rounded">
                        </div>
                        <div class="in" >
                            <strong>{{ username }}</strong>
                            <div class="text-muted">
                                <ion-icon name="location"></ion-icon>
                                California
                            </div>
                        </div>
                        <a href="#" class="close-sidebar-button" data-bs-dismiss="modal">
                            <ion-icon name="close"></ion-icon>
                        </a>
                    </div>
                    <!-- * profile box -->

                    <ul class="listview flush transparent no-line image-listview mt-2">
                        <li>
                            <div class="item">
                                <div class="icon-box bg-primary">
                                    <ion-icon name="moon-outline"></ion-icon>
                                </div>
                                <div class="in">
                                    <div>Dark Mode</div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input dark-mode-switch" type="checkbox"
                                            id="darkmodesidebar">
                                        <label class="form-check-label" for="darkmodesidebar"></label>
                                    </div>
                                </div>
                            </div>
                        </li>
                    <div class="listview-title mt-2 mb-1">
                        <span>Filters</span>
                    </div>
                        <li>
                        <div>
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed bg-transparent" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#accordion1">
                                    <a class="item">Categories</a>
                                </button>
                            </h2>
                            <div id="accordion1" class="accordion-collapse collapse" data-bs-parent="#accordion1">
                                <div class="accordion-body">
                                    <p>Choose some categories</p>
                                <div class="form-check mb-1">
                                    <input type="checkbox" class="form-check-input" id="customCheckb1">
                                    <label class="form-check-label" for="customCheckb1">Sport</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" class="form-check-input" id="customCheckb2">
                                    <label class="form-check-label" for="customCheckb2">Music</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" class="form-check-input" id="customCheckb3">
                                    <label class="form-check-label" for="customCheckb3">Food</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" class="form-check-input" id="customCheckb4">
                                    <label class="form-check-label" for="customCheckb4">Education</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" class="form-check-input" id="customCheckb5">
                                    <label class="form-check-label" for="customCheckb5">Digital</label>
                                </div>
                                </div>
                            </div>
                        </div>
                        </li>
                        <li>
                             <h2 class="accordion-header">
                                <button class="accordion-button collapsed bg-transparent" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#accordion2">
                                    <a class="item">Price</a>
                                </button>
                            </h2>
                            <div id="accordion2" class="accordion-collapse collapse" data-bs-parent="#accordion2">
                                <div class="accordion-body">
                                <form>
                                <div class="form-group boxed mb-1">
                                    <div class="input-wrapper">
                                        <label class="form-label" for="name5">Min</label>
                                        <input type="text" class="form-control" id="name5" placeholder="Minimal budget"
                                            autocomplete="off">
                                        <i class="clear-input">
                                            <ion-icon name="close-circle"></ion-icon>
                                        </i>
                                    </div>
                                    <br>
                                    <div class="input-wrapper">
                                        <label class="form-label" for="name5">Max</label>
                                        <input type="text" class="form-control" id="name5" placeholder="Maximal budget"
                                            autocomplete="off">
                                        <i class="clear-input">
                                            <ion-icon name="close-circle"></ion-icon>
                                        </i>
                                    </div>
                                </div>
                              </form>
                                </div>
                            </div>

                        </li>
                        <div class="wide-block pt-2 pb-2 bg-transparent">
                            <button type="button" class="btn btn-primary btn-sm btn-block">BUTTON</button>
                        </div>
                    </ul>

                <!-- sidebar buttons -->
                <div class="sidebar-buttons">
                    <a href="/profile" class="button">
                        <ion-icon name="person-outline"></ion-icon>
                    </a>
                    <a href="/logout" class="button">
                        <ion-icon name="log-out-outline"></ion-icon>
                    </a>
                </div>
                <!-- * sidebar buttons -->
            </div>
        </div>
    </div>
    <!-- * App Sidebar -->

    <!-- ============== Js Files ==============  -->
    <script>
		var longitude, latitude;

    <!-- ============= Geo Localization ======== -->
        function ipLookUp () {
          $.ajax('http://ip-api.com/json')
          .then(
              function success(response) {
                  console.log('User\'s Location Data is ', response);
                  console.log('User\'s Country', response.country);
                  getAddress(response.lat, response.lon)
        },

              function fail(data, status) {
                  console.log('Request failed.  Returned status of',
                              status);
              }
          );
        }

        function getAddress (latitude, longitude) {
          $.ajax('https://maps.googleapis.com/maps/api/geocode/json?' +
                  'latlng=' + latitude + ',' + longitude + '&key=' +
                  'AIzaSyCPl2iHJylG3zBfQ9TJs2voLPlBnz_IITA')
          .then(
            function success (response) {
              console.log('User\'s Address Data is ', response)
            },
            function fail (status) {
              console.log('Request failed.  Returned status of',
                          status)
            }
           )
        }

        if ("geolocation" in navigator) {
          // check if geolocation is supported/enabled on current browser
          navigator.geolocation.getCurrentPosition(
           function success(position) {
             // for when getting location is a success
             console.log('latitude', position.coords.latitude,
                         'longitude', position.coords.longitude);
                window.longitude = position.coords.longitude
                window.latitude = position.coords.latitude

             getAddress(position.coords.latitude,
                        position.coords.longitude)
           },
          function error(error_message) {
            // for when getting location results in an error
            console.error('An error has occurred while retrieving' +
                          'location', error_message)
            ipLookUp()
          });
        } else {
          // geolocation is not supported
          // get your location some other way
          console.log('geolocation is not enabled on this browser')
          ipLookUp()
        }

        <!-- ============= Search bar autocomplete ======= -->

        // This example adds a search box to a map, using the Google Place Autocomplete
        // feature. People can enter geographical searches. The search box will return a
        // pick list containing a mix of places and predicted search terms.
        // This example requires the Places library. Include the libraries=places
        // parameter when you first load the API. For example:
        // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

        const contentString =
        '<div class="card">' +
        '<div class="card-header">Card Header</div>' +
        '<div class="card-body">' +
        '<h5 class="card-title">Title</h5>' +
        '<p class="card-text">With supporting text below as a natural lead-in to additional content.</p>'+
        '<a href="#" class="btn btn-primary">Go somewhere</a>'+
        '</div>'+
        '<div class="card-footer">'+
        'This is card footer'+
        '</div>';

        function initAutocomplete() {
          const map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: latitude, lng: longitude },
            zoom: 15,
            mapTypeId: "roadmap",
            zoomControl: false,
            mapTypeControl: false,
              scaleControl: false,
              streetViewControl: false,
              rotateControl: true,
              fullscreenControl: false
          });
          // Set LatLng and title text for the markers. The first marker (Boynton Pass)
            // receives the initial focus when tab is pressed. Use arrow keys to
            // move between markers; press tab again to cycle through the map controls.
            const tourStops = [
            [{ lat: latitude, lng: longitude }, "Example position"],
            ];
            // Create an info window to share between markers.
            const infoWindow = new google.maps.InfoWindow();
            // Create the markers.
            tourStops.forEach(([position, title], i) => {
            const marker = new google.maps.Marker({
              position,
              map,
              title: `${i + 1}. ${title}`,
              label: `${i + 1}`,
              optimized: false,
              icon: {
                  url: "static/assets/img/icon/maps.png",
                  scaledSize: new google.maps.Size(50, 50) // pixels
              }
            });
            // Add a click listener for each marker, and set up the info window.
            marker.addListener("click", () => {
              infoWindow.close();
              infoWindow.setContent(contentString); //marker.getTitle()
              infoWindow.open(marker.getMap(), marker);
            });
            });

          // Create the search box and link it to the UI element.
          const input = document.getElementById("pac-input");
          const searchBox = new google.maps.places.SearchBox(input);
          map.controls[google.maps.ControlPosition.TOP_CENTER].push(input);
          // Bias the SearchBox results towards current map's viewport.
          map.addListener("bounds_changed", () => {
            searchBox.setBounds(map.getBounds());
          });
          let markers = [];
          // Listen for the event fired when the user selects a prediction and retrieve
          // more details for that place.
          searchBox.addListener("places_changed", () => {
            const places = searchBox.getPlaces();

            if (places.length === 0) {
              return;
            }
            // Clear out the old markers.
            markers.forEach((marker) => {
              marker.setMap(null);
            });
            markers = [];
            // For each place, get the icon, name and location.
            const bounds = new google.maps.LatLngBounds();
            places.forEach((place) => {
              if (!place.geometry || !place.geometry.location) {
                console.log("Returned place contains no geometry");
                return;
              }
              const icon = {
                url: place.icon,
                size: new google.maps.Size(71, 71),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(17, 34),
                scaledSize: new google.maps.Size(25, 25),
              };
              // Create a marker for each place.
              markers.push(
                new google.maps.Marker({
                  map,
                  icon,
                  title: place.name,
                  position: place.geometry.location,
                })
              );

              if (place.geometry.viewport) {
                // Only geocodes have viewport.
                bounds.union(place.geometry.viewport);
              } else {
                bounds.extend(place.geometry.location);
              }
            });
            map.fitBounds(bounds);
          });
        }

	</script>
    <!-- Bootstrap -->
    <script src="/static/assets/js/lib/bootstrap.min.js"></script>
    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.js"></script>
    <!-- Splide -->
    <script src="/static/assets/js/plugins/splide/splide.min.js"></script>
    <!-- ProgressBar js -->
    <script src="/static/assets/js/plugins/progressbar-js/progressbar.min.js"></script>
    <!-- Base Js File -->
    <script src="/static/assets/js/base.js"></script>


    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPl2iHJylG3zBfQ9TJs2voLPlBnz_IITA&callback=initAutocomplete&libraries=places&v=weekly"
      async
    ></script>



</body>
</html>